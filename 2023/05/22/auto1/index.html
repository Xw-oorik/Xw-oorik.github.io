


<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>  Auto进阶 |    Oorik.</title>
  <meta name="description" content="A minimalist theme for hexo.">
  <!-- 标签页图标 -->
  
  <link rel="shortcut icon" href="https://cdn4.iconfinder.com/data/icons/emoji-18/61/21-64.png" type="image/x-icon">
  

  <!-- 图标库 -->
  <link href="https://cdn.jsdelivr.net/npm/remixicon@2.2.0/fonts/remixicon.css" rel="stylesheet">
  <!-- 动画库 -->
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fushaolei/cdn-white@1.0/css/animate.css"/>
  
  <!-- css文件 -->
  
<link rel="stylesheet" href="/css/white.css">

  <!-- 代码高亮 -->
  
    
      
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.1.1/styles/github.css">

    
  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>

<div class="menu-outer">
    <div class="menu-inner">
      <div class="menu-site-name  animate__animated  animate__fadeInUp">
        <a href="/">
          Oorik.
        </a>
        
      </div>
      <div class="menu-group">
        <ul class="menu-ul">
        
          <a href="/" class="nav-link">
            <li class="menu-li  animate__animated  animate__fadeInUp">
              HOME
            </li>
          </a>
        
          <a href="/archives" class="nav-link">
            <li class="menu-li  animate__animated  animate__fadeInUp">
              BLOG
            </li>
          </a>
        
        
          <li class="menu-li animate__animated  animate__fadeInUp" id="sort">
             CATEGORIES
             <div class="categories-outer " id="sort-div">
               <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Cpp%E8%BF%9B%E9%98%B6/">Cpp进阶</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/C%E8%BF%9B%E9%98%B6/">C进阶</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Life/">Life</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tips/">Tips</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B7%A5%E4%BD%9C/">工作</a></li></ul>
             </div>
          </li>
        
        
        <a href="/search">
          <li class="menu-li  animate__animated  animate__fadeInUp">
            <i class="ri-search-line"></i>
          </li>
        </a>
        
          <li class="menu-li animate__animated  animate__fadeInUp" id="mobile-menu">
            <i class="ri-menu-line"></i>
          </li>
        
        </ul>

      </div>

    </div>
</div>
<div id="mobile-main" class="animate__animated  animate__fadeIn">
  <div class="mobile-menu-inner">
    <div class="mobile-menu-site-name animate__animated  animate__fadeInUp">
      <a href="/">
        Oorik.
      </a>
    </div>
    <div class="mobile-menu-group" id="mobile-close">
      <i class="ri-close-line"></i>
    </div>

  </div>

  <div class="mobile-menu-div">
  
    <a href="/" class="mobile-nav-link">
      <div class="mobile-menu-child animate__animated  animate__fadeInUp">
        <span>HOME</span>
      </div>
    </a>
  
    <a href="/archives" class="mobile-nav-link">
      <div class="mobile-menu-child animate__animated  animate__fadeInUp">
        <span>BLOG</span>
      </div>
    </a>
  
  
    <a href="/search">  
      <div class="mobile-menu-child  animate__animated  animate__fadeInUp">
        <i class="ri-search-line"></i>
      </div>
    </a>
    
  </div>


</div>

<div class="body-outer">
  <div class="body-inner">
    
<article class="post-inner">
  <div class="post-content-outer">
    <div class="post-intro">
      <div class="post-title animate__animated  animate__fadeInUp">auto进阶</div>
      <div class="meta-intro animate__animated  animate__fadeInUp">May 22 2023</div>
      
    </div>
    <div class="post-content-inner">
      <div class="post-content-inner-space">

      </div>
      <div class="post-content-main animate__animated  animate__fadeInUp">
        <!-- top型目录 -->
        
        <h1 id="auto💓"><a href="#auto💓" class="headerlink" title="auto💓"></a>auto💓</h1><h3 id="本篇开启Cpp进阶系列"><a href="#本篇开启Cpp进阶系列" class="headerlink" title="本篇开启Cpp进阶系列"></a>本篇开启Cpp进阶系列</h3><p>&#x3D;&#x3D;auto在编译期间自动推导出变量的类型。&#x3D;&#x3D;</p>
<p>&#x3D;&#x3D;auto 仅仅是一个占位符，在编译器期间它会被真正的类型所替代。&#x3D;&#x3D;</p>
<p>auto在版本迭代中技巧太多，下面简单总结。注意auto是不能用在定义数组的，下面我说的都是版本证实的</p>
<p>在C++11中，<code>auto</code>关键字不能用于定义数组。例如：</p>
<pre><code class="c++">c++复制代码auto arr[] = &#123;1, 2, 3&#125;; // 编译错误
</code></pre>
<p>上面的示例中，<code>auto</code>关键字用于定义数组，但是编译会失败，因为编译器无法推断出数组的类型。</p>
<p>如果要使用<code>auto</code>关键字定义类型，则需要将其用于定义数组的元素，并使用大括号括起来初始化数组。例如：</p>
<pre><code class="c++">c++复制代码auto x = 1; // 推导为int类型
auto arr = &#123;1, 2, 3&#125;; // 推导为std::initializer_list&lt;int&gt;
eg:
int main() &#123;
    auto arr = &#123;1, 2, 3&#125;;
    for(auto x:arr)
    &#123;
        cout&lt;&lt;x&lt;&lt;endl;
    &#125;
    getchar();
    return 0;
&#125;
</code></pre>
<p>在上面的示例中，<code>auto</code>关键字用于定义变量<code>x</code>和数组<code>arr</code>的元素类型，并且使用大括号初始化<code>arr</code>数组，此时编译器可以自动推导出<code>arr</code>数组的类型为<code>std::initializer_list&lt;int&gt;</code>。</p>
<p>如果需要使用<code>auto</code>关键字定义数组，可以使用C++17中新增的<code>auto</code>作为数组的元素类型来实现。例如：</p>
<pre><code class="c++">c++复制代码auto arr = std::array&#123;1, 2, 3&#125;; // 推导为std::array&lt;int, 3&gt;
</code></pre>
<p>在上面的示例中，使用<code>std::array</code>和<code>auto</code>关键字定义了一个数组<code>arr</code>，此时编译器可以自动推导出<code>arr</code>数组的类型为<code>std::array&lt;int, 3&gt;</code>。</p>
<h2 id="C-11"><a href="#C-11" class="headerlink" title="C++11"></a>C++11</h2><p>C++11 中引入了一个新的关键字 <code>auto</code> , 用于自动型别推导. 同时引入了一个新的写法.</p>
<pre><code class="cpp">auto func(T parameters) -&gt; type;
</code></pre>
<p>把函数返回类型写在后面, 这叫做 trailing return type. 这个写法等价于把 type 放在前面的通常函数, 比如</p>
<pre><code class="cpp">type func(T parameters);
</code></pre>
<p><strong>所以说 <code>auto</code> 关键字只是一个占位符</strong>, 不过配合上同为 C++11 引入的 <code>decltype</code> 关键字, 就可以进行类型推导. 比如下面这个模板函数</p>
<pre><code class="cpp">template &lt;typename U, typename V&gt;
auto add(U a, V b) -&gt; decltype(a + b);
// add(float, double) 返回 double
// add(float, int) 返回 float
// 诸如此类
</code></pre>
<p>这样可以通过 <code>a + b</code> 的型别推断出 <code>add</code> 函数的返回类型. 这样的话, 返回的型别就可以利用函数参数的型别所决定了.</p>
<h2 id="C-14"><a href="#C-14" class="headerlink" title="C++14"></a>C++14</h2><h3 id="新的占位符-auto"><a href="#新的占位符-auto" class="headerlink" title="新的占位符 auto"></a>新的占位符 auto</h3><p>C++14 允许你在函数定义的时候, 使用真正的 <code>auto</code> , 如果在一个函数定义的时候用上 <code>auto</code> , 那他就会按照下面这个方式推断.</p>
<pre><code class="cpp">auto func(T parameters)&#123;
    return something;
&#125;
</code></pre>
<p>这个 auto 推导的结果就相当于</p>
<pre><code class="cpp">auto value = something;
</code></pre>
<p>之中的 auto 所推导的结果. 类似地, <code>auto &amp;</code> , <code>auto &amp;&amp;</code> , <code>const auto</code> , <code>const auto &amp;</code> 等关键字也都是这个原理.</p>
<p>这些关键字使用上是有区别的, 比如 <code>auto &amp;</code> 只能返回左值引用, 而 <code>auto &amp;&amp;</code> 既能返回左值引用, 又能返回右值引用. <code>auto</code> 只能返回一个型别. 等等.</p>
<p>这样子的写法只能在函数定义中使用, 因为必须同时提供返回值才能完成推导.</p>
<h3 id="老的占位符-auto"><a href="#老的占位符-auto" class="headerlink" title="老的占位符 auto"></a>老的占位符 auto</h3><p>C++14 为 C++11 中这种写法</p>
<pre><code class="cpp">auto func(T parameter) -&gt; decltype(something) // decltype() 中就是返回值
&#123;
    return something;
&#125;
</code></pre>
<p>留了个简化的写法:</p>
<pre><code class="cpp">decltype(auto) func(T parameter)
&#123;
    return something;
&#125;
</code></pre>
<p>同样我们需要给出函数的 definition, 而不只是 declaration.</p>
<p>这就是常用的 <code>decltype(auto)</code> 的含义了.</p>
<p><code>decltype</code> 的推导规则和 <code>auto</code> , <code>auto &amp;</code> , <code>auto &amp;&amp;</code> , <code>const auto</code> , <code>const auto &amp;</code> 等<strong>都不一样</strong>. 它既可以返回类型, 又可以返回左右值引用, 还会保留 <code>const</code> 语义, 挺不一样的.</p>
<h2 id="用在-lambda-中"><a href="#用在-lambda-中" class="headerlink" title="用在 lambda 中"></a>用在 lambda 中</h2><p>定义一个典型的 lambda 实际上需要</p>
<ol>
<li>捕获 [],</li>
<li>函数参数 (),</li>
<li>返回类型 <code>type</code>,</li>
<li>函数定义 {}.</li>
</ol>
<pre><code class="cpp">auto f = []() -&gt; type &#123;&#125;;
</code></pre>
<p>这里我们省略了一些关键字, 比如 <code>mutable</code> , <code>noexcept</code> 等. C++17 中还可以用 <code>constexpr</code> 等关键字.</p>
<p>当然这个 <code>-&gt; type</code> 也可以不写. 不写就意味着被 C++14 中的 <code>-&gt; auto</code> 占位了. 包括 C++11 也是这样的, 尽管 C++11 中还没有 <code>auto</code> 的这个用法.</p>
<h2 id="函数参数的-auto"><a href="#函数参数的-auto" class="headerlink" title="函数参数的 auto"></a>函数参数的 auto</h2><p>我们刚刚说的都是返回类型的地方放一个 <code>auto</code> . 我们下面来聊聊函数参数中的 <code>auto</code> .</p>
<h2 id="lambda-参数中的-auto"><a href="#lambda-参数中的-auto" class="headerlink" title="lambda 参数中的 auto"></a>lambda 参数中的 auto</h2><p>C++ 14 中允许了 lambda 参数使用 <code>auto</code> , <code>auto &amp;&amp;</code> 等等 C++14 的类型占位符. 你可以写出这样的代码:</p>
<pre><code class="cpp">auto sum = [](auto x, auto y) &#123; return x + y; &#125;;
</code></pre>
<p><code>sum</code> 就有点像模板了, 遇到的时候会自行推断 <code>x + y</code> 的型别. 尽管如此, 你仍然不能写一个具有函数模板形式的 lambda.</p>
<h2 id="普通函数中的-auto"><a href="#普通函数中的-auto" class="headerlink" title="普通函数中的 auto"></a>普通函数中的 auto</h2><p>我们知道长期以来, C++ 有函数模板, 而 lambda 的参数可以用 auto 变得像函数模板一样. 这两个东西这么像, 终于在 C++20 中得到了统一.</p>
<p>在 C++20 中, 我们在函数参数中也可以用 <code>auto</code> , <code>auto &amp;</code> , <code>auto &amp;&amp;</code> 等等之一了. 而在 lambda 中, 我们也可以使用显式的模板参数列表了. 你可以写出:</p>
<pre><code class="cpp">auto add(auto x, auto y)
&#123;
    return x + y;
&#125;
</code></pre>
<p>这种很奇怪的代码了.</p>
<p>也可以写出</p>
<pre><code class="cpp">auto add = []&lt;typename T, typename S&gt;(T x, S y) &#123; return x + y; &#125;;
</code></pre>
<p><strong>参考：</strong></p>
<p><a target="_blank" rel="noopener" href="https://www.zhihu.com/column/c_1267952684679827456">C++干货系列 - 知乎 (zhihu.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.zhihu.com/column/c_1330233721316470784">C&#x2F;C++技术 - 知乎 (zhihu.com)</a></p>

        <!-- 分类文章 -->
        
          <div class="post-categoris-bottom">
            <div class="post-categoris-name">Cpp进阶</div>
            <ul>
            
            
              
            
            
            
              
            
            
            
              
            
            
            
              
            
            
            
              
            
            
            
              
            
            
            
              
                <li class="base">
                  <a  href="/2023/05/22/cplus/" class="post-categoris-bottom-link">
                  Cplusplus总结
                </a>
                </li>
              
              
            
            
            
              
                <li class="me base">
                  <a  href="/2023/05/22/auto1/" class="post-categoris-bottom-link">
                  auto进阶
                </a>
                </li>
              
              
            
            
            
              
                <li class="base">
                  <a  href="/2023/05/22/cpp%E6%A8%A1%E6%9D%BF1/" class="post-categoris-bottom-link">
                  Cpp模板细讲
                </a>
                </li>
              
              
            
            
            
              
            
            
            
              
            
            
            
              
            
            
            
              
            
            
            </ul>

          </div>

        
      </div>
      <div class="post-content-inner-space">
        
          <div class="space-toc-main animate__animated  animate__fadeInUp">
            <ol class="space-toc"><li class="space-toc-item space-toc-level-2"><a class="space-toc-link" href="#C-11"><span class="space-toc-text">C++11</span></a></li><li class="space-toc-item space-toc-level-2"><a class="space-toc-link" href="#C-14"><span class="space-toc-text">C++14</span></a></li><li class="space-toc-item space-toc-level-2"><a class="space-toc-link" href="#%E7%94%A8%E5%9C%A8-lambda-%E4%B8%AD"><span class="space-toc-text">用在 lambda 中</span></a></li><li class="space-toc-item space-toc-level-2"><a class="space-toc-link" href="#%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0%E7%9A%84-auto"><span class="space-toc-text">函数参数的 auto</span></a></li><li class="space-toc-item space-toc-level-2"><a class="space-toc-link" href="#lambda-%E5%8F%82%E6%95%B0%E4%B8%AD%E7%9A%84-auto"><span class="space-toc-text">lambda 参数中的 auto</span></a></li><li class="space-toc-item space-toc-level-2"><a class="space-toc-link" href="#%E6%99%AE%E9%80%9A%E5%87%BD%E6%95%B0%E4%B8%AD%E7%9A%84-auto"><span class="space-toc-text">普通函数中的 auto</span></a></li></ol>
           </div>
        
      </div>
   </div>
    <!-- 评论 -->
    
  </div>
</article>
  </div>
</div>



<!-- 如果是home模式的话，不在首页就显示footer，如果不是home模式的话 所有都显示footer -->

  <div class="footer-outer animate__animated  animate__fadeInUp">
    <div class="footer-inner">
    <div class="footer-text">
    <p>Power by <a target="_blank" rel="noopener" href="http://hexo.io/">Hexo</a> Theme by <a target="_blank" rel="noopener" href="https://github.com/Xw-oorik/xw-oorik.github.io">Pot ba</a></p>

    </div>
    <div class="footer-contact">
    <ul class="footer-ul">
        
        <li class="footer-li">
            <a href="https://github.com/Xw-oorik/xw-oorik.github.io" target="_blank">
                <i class="ri-github-line"></i>
            </a>
        </li>
        
        <li class="footer-li">
            <a href="mailto:820735157@qq.com" target="_blank">
                <i class="ri-mail-line"></i>
            </a>
        </li>
        
        <li class="footer-li">
            <a href="https://blog.csdn.net/weixin_51609435?spm=1000.2115.3001.5343" target="_blank">
                <i class="ri-pages-fill"></i>
            </a>
        </li>
        
    </ul>
    </div>
    </div>
</div>






<script src="/js/white.js"></script>



    
      
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/highlight.min.js"></script>

      <script>hljs.initHighlightingOnLoad();</script>
    

</body>
</html>

<link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css">

<script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
<script src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js"> </script>

<script src="/js/fancybox.js"></script>

